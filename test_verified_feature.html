<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Verified Feature</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container mt-4">
        <h1>Verified Status Feature Test</h1>
        
        <div class="alert alert-info">
            <h4>Test Results:</h4>
            <ul id="test-results"></ul>
        </div>
        
        <div class="card">
            <div class="card-body">
                <h5>Manual Test Session</h5>
                <div class="d-flex align-items-center">
                    <span>Test Session:</span>
                    <span id="verified-btn-overlay-test" style="display: inline-flex; align-items: center; justify-content: center; width: 32px; height: 32px; border-radius: 50%; background: rgba(224,224,224,0); cursor: pointer; margin-left: 8px;">
                        <i id="verified-btn-test" class="fa-solid fa-check" style="color: #dee2e6; font-size: 18px;"></i>
                    </span>
                </div>
                <small class="text-muted">Click the checkmark to test toggle functionality</small>
            </div>
        </div>
    </div>

    <script>
        // Test the verified feature functionality
        async function runTests() {
            const results = document.getElementById('test-results');
            
            function addResult(test, passed, details = '') {
                const li = document.createElement('li');
                li.className = passed ? 'text-success' : 'text-danger';
                li.innerHTML = `<i class="fa-solid fa-${passed ? 'check' : 'times'}"></i> ${test} ${details}`;
                results.appendChild(li);
            }
            
            try {
                // Test 1: Check if API endpoints are accessible
                const sessionsResponse = await fetch('/api/sessions');
                const sessionsData = await sessionsResponse.json();
                addResult('API Sessions Endpoint', sessionsResponse.ok, `- Found ${sessionsData.length} sessions`);
                
                // Test 2: Check if verified field exists in sessions
                const hasVerifiedField = sessionsData.length > 0 && sessionsData[0].hasOwnProperty('verified');
                addResult('Verified Field in Sessions API', hasVerifiedField);
                
                // Test 3: Test a specific session endpoint
                if (sessionsData.length > 0) {
                    const sessionId = sessionsData[0].session_id;
                    const sessionResponse = await fetch(`/api/session/${sessionId}`);
                    const sessionData = await sessionResponse.json();
                    const hasVerifiedInSession = sessionData.session_info && sessionData.session_info.hasOwnProperty('verified');
                    addResult('Verified Field in Session Data', hasVerifiedInSession);
                }
                
                // Test 4: Test UI toggle functionality
                setupUITest();
                addResult('UI Toggle Setup', true, '- Manual test available below');
                
            } catch (error) {
                addResult('Test Execution', false, `- Error: ${error.message}`);
            }
        }
        
        function setupUITest() {
            const verified_btn_overlay = document.getElementById('verified-btn-overlay-test');
            const verified_btn = document.getElementById('verified-btn-test');
            let isVerified = false;
            
            // Hover effects
            verified_btn_overlay.addEventListener('mouseenter', () => {
                verified_btn_overlay.style.background = 'rgba(0,0,0,0.1)';
            });
            
            verified_btn_overlay.addEventListener('mouseleave', () => {
                verified_btn_overlay.style.background = 'rgba(224,224,224,0)';
            });
            
            // Click handling to toggle verified status
            verified_btn_overlay.addEventListener('click', () => {
                isVerified = !isVerified;
                verified_btn.style.color = isVerified ? '#28a745' : '#dee2e6';
                console.log('Verified status toggled to:', isVerified);
            });
        }
        
        // Run tests when page loads
        document.addEventListener('DOMContentLoaded', runTests);
    </script>
</body>
</html>
